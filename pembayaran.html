<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mochique - Beranda</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .product { border: 1px solid #ccc; padding: 10px; margin: 10px; display: inline-block; width: 250px; text-align: center; }
        .cart { margin-top: 20px; border-top: 1px solid #000; padding-top: 10px; }
        button { padding: 5px 10px; margin: 5px; }
        .modal { display: none; position: fixed; z-index: 1; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.4); }
        .modal-content { background-color: #fefefe; margin: 15% auto; padding: 20px; border: 1px solid #888; width: 80%; max-width: 500px; }
        .close { color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer; }
        .close:hover { color: black; }
        .stars { display: flex; justify-content: center; margin: 10px 0; }
        .star { font-size: 30px; color: #ddd; cursor: pointer; }
        .star.selected { color: gold; }
        textarea { width: 100%; height: 80px; margin: 10px 0; }
        .reviews { margin-top: 20px; text-align: left; }
        .review-item { border-bottom: 1px solid #eee; padding: 10px 0; }
        .payment-option { margin: 10px 0; }
        .payment-option label { margin-right: 20px; }
        .qris-qr { text-align: center; margin-top: 20px; }
        .qris-qr img { width: 200px; height: 200px; } /* Simulasi QR code */
    </style>
</head>
<body>
    <h1>Selamat Datang di Mochique</h1>
    <p>Toko Online Sederhana untuk berbelanja Mochique lezat.</p>

    <h2>Beranda - Produk Mochique</h2>
    <div id="products">
        <!-- Produk akan dimuat oleh JavaScript -->
    </div>

    <!-- Modal untuk detail produk -->
    <div id="productModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2 id="modal-title"></h2>
            <p><strong>Harga:</strong> Rp <span id="modal-price"></span></p>
            <p><strong>Rating Rata-rata:</strong> <span id="modal-rating"></span>/5</p>
            <div class="reviews">
                <h3>Ulasan Pengguna</h3>
                <div id="reviews-list"></div>
            </div>
            <h3>Beri Rating dan Ulasan</h3>
            <div class="stars" id="rating-stars">
                <span class="star" data-value="1">★</span>
                <span class="star" data-value="2">★</span>
                <span class="star" data-value="3">★</span>
                <span class="star" data-value="4">★</span>
                <span class="star" data-value="5">★</span>
            </div>
            <textarea id="user-review" placeholder="Ketik ulasan Anda di sini..."></textarea>
            <button onclick="submitReview()">Kirim</button>
        </div>
    </div>

    <!-- Modal untuk checkout dan pembayaran -->
    <div id="checkoutModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeCheckoutModal()">&times;</span>
            <h2>Checkout</h2>
            <p>Total Pembayaran: Rp <span id="checkout-total"></span></p>
            <div class="payment-option">
                <label><input type="radio" name="payment" value="cash" checked> Cash (Bayar Tunai)</label>
                <label><input type="radio" name="payment" value="qris"> QRIS</label>
            </div>
            <div id="qris-section" style="display: none;">
                <p>Scan QR code berikut untuk pembayaran via QRIS:</p>
                <div class="qris-qr">
                    <img src="https://via.placeholder.com/200x200?text=QRIS+Code" alt="QRIS QR Code"> <!-- Ganti dengan gambar QR code asli jika ada -->
                </div>
            </div>
            <button onclick="confirmPayment()">Konfirmasi Pembayaran</button>
        </div>
    </div>

    <div class="cart">
        <h2>Keranjang Belanja</h2>
        <ul id="cart-items"></ul>
        <p>Total: Rp <span id="total">0</span></p>
        <button onclick="checkout()">Checkout</button>
    </div>

    <script>
        // Data produk Mochique (dengan detail tambahan dan ulasan awal)
        let products = [
            { 
                id: 1, 
                name: "Mochique Matcha", 
                price: 25000, 
                rating: 4.5, 
                reviews: [
                    { rating: 5, text: "Enak banget, tekstur lembut dan rasa matcha yang autentik! Cocok untuk pecinta teh hijau." },
                    { rating: 4, text: "Bagus, tapi agak manis." }
                ]
            },
            { 
                id: 2, 
                name: "Mochique Strawberry Chocolate", 
                price: 30000, 
                rating: 4.8, 
                reviews: [
                    { rating: 5, text: "Kombinasi strawberry dan cokelat yang sempurna, manis dan segar. Bikin nagih!" }
                ]
            },
            { 
                id: 3, 
                name: "Mochique Mango Cream", 
                price: 28000, 
                rating: 4.7, 
                reviews: [
                    { rating: 5, text: "Rasa mangga yang juicy dengan cream lembut, seperti musim panas dalam satu gigitan." }
                ]
            }
        ];

        // Keranjang belanja (array untuk menyimpan item)
        let cart = [];
        let total = 0;
        let currentProductId = null; // Untuk menyimpan ID produk yang sedang dilihat

        // Fungsi untuk menampilkan produk
        function displayProducts() {
            const productContainer = document.getElementById('products');
            products.forEach(product => {
                const productDiv = document.createElement('div');
                productDiv.className = 'product';
                productDiv.innerHTML = `
                    <h3>${product.name}</h3>
                    <p>Harga: Rp ${product.price}</p>
                    <button onclick="addToCart(${product.id})">Tambah ke Keranjang</button>
                    <button onclick="showDetail(${product.id})">Cek Detail</button>
                `;
                productContainer.appendChild(productDiv);
            });
        }

        // Fungsi untuk menambah produk ke keranjang
        function addToCart(productId) {
            const product = products.find(p => p.id === productId);
            cart.push(product);
            total += product.price;
            updateCart();
        }

        // Fungsi untuk memperbarui tampilan keranjang
        function updateCart() {
            const cartItems = document.getElementById('cart-items');
            cartItems.innerHTML = '';
            cart.forEach(item => {
                const li = document.createElement('li');
                li.textContent = `${item.name} - Rp ${item.price}`;
                cartItems.appendChild(li);
            });
            document.getElementById('total').textContent = total;
        }

        // Fungsi untuk menampilkan detail produk di modal
        function showDetail(productId) {
            const product = products.find(p => p.id === productId);
            currentProductId = productId;
            document.getElementById('modal-title').textContent = product.name;
            document.getElementById('modal-price').textContent = product.price;
            document.getElementById('modal-rating').textContent = calculateAverageRating(product.reviews);
            displayReviews(product.reviews);
            resetRatingStars();
            document.getElementById('user-review').value = '';
            document.getElementById('productModal').style.display = 'block';
        }

        // Fungsi untuk menghitung rating rata-rata
        function calculateAverageRating(reviews) {
            if (reviews.length === 0) return 0;
            const sum = reviews.reduce((acc, review) => acc + review.rating, 0);
            return (sum / reviews.length).toFixed(1);
        }

        // Fungsi untuk menampilkan ulasan
        function displayReviews(reviews) {
            const reviewsList = document.getElementById('reviews-list');
            reviewsList.innerHTML = '';
            reviews.forEach(review => {
                const reviewDiv = document.createElement('div');
                reviewDiv.className = 'review-item';
                reviewDiv.innerHTML = `<strong>Rating: ${review.rating}/5</strong><br>${review.text}`;
                reviewsList.appendChild(reviewDiv);
            });
        }

        // Fungsi untuk reset bintang rating
        function resetRatingStars() {
            const stars = document.querySelectorAll('.star');
            stars.forEach(star => star.classList.remove('selected'));
        }

        // Event listener untuk bintang rating
        document.getElementById('rating-stars').addEventListener('click', function(e) {
            if (e.target.classList.contains('star')) {
                const value = parseInt(e.target.getAttribute('data-value'));
                resetRatingStars();
                for (let i = 0; i < value; i++) {
                    document.querySelectorAll('.star')[i].classList.add('selected');
                }
            }
        });

        // Fungsi untuk submit ulasan
        function submitReview() {
            const selectedStars = document.querySelectorAll('.star.selected').length;
            const reviewText = document.getElementById('user-review').value.trim();
            if (selectedStars === 0 || reviewText === '') {
                alert('Harap beri rating dan tulis ulasan!');
                return;
            }
            const product = products.find(p => p.id === currentProductId);
            product.reviews.push({ rating: selectedStars, text: reviewText });
            product.rating = calculateAverageRating(product.reviews); // Update rating rata-rata
            alert('Ulasan berhasil dikirim!');
            showDetail(currentProductId); // Refresh modal
        }

        // Fungsi untuk menutup modal detail
        function closeModal() {
            document.getElementById('productModal').style.display = 'none';
        }

        // Fungsi checkout (buka modal checkout)
        function checkout() {
            if (cart.length === 0) {
                alert('Keranjang kosong! Tambahkan produk dulu.');
                return;
            }
            document.getElementById('checkout-total').textContent = total;
            document.getElementById('checkoutModal').style.display = 'block';
            // Reset radio button dan sembunyikan QRIS
            document.querySelector('input[name="payment"][value="cash"]').checked = true;
            document.getElementById('qris-section').style.display = 'none';
        }

        // Event listener untuk radio button pembayaran
        document.querySelectorAll('input[name="payment"]').forEach(radio => {
            radio.addEventListener('change', function() {
                if (this.value === 'qris') {
                    document.getElementById('qris-section').style.display = 'block';
                } else {
                    document.getElementById('qris-section').style.display = 'none';
                }
            });
        });

        // Fungsi konfirmasi pembayaran
        function confirmPayment() {
            const paymentMethod = document.querySelector('input[name="payment"]:checked').value;
            if (paymentMethod === 'cash') {
                alert(`Pembayaran cash berhasil! Total: Rp ${total}. Silakan bayar di kasir.`);
            } else if (paymentMethod === 'qris') {
                alert(`Pembayaran QRIS berhasil! Total: Rp ${total}. Terima kasih telah berbelanja.`);
            }
            cart = [];
            total = 0;
            updateCart();
            closeCheckoutModal();
        }

        // Fungsi untuk menutup modal checkout
        function closeCheckoutModal() {
            document.getElementById('checkoutModal').style.display = 'none';
        }

        // Jalankan saat halaman dimuat
        window.onload = displayProducts;
    </script>
</body>
</html>
